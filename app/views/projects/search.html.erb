<div class="page-header">
  <h1 class="page-title">Projects Search</h1>
</div>

<div class="col-12">
  <div class="card">
    <div class="card-body">
      <%= form_tag search_projects_path, method: :get, class:'col-lg-12' do %>
      <div class="row gutters-xs">
        <div class="col">
          <%= text_field_tag :search, params[:search], class: 'form-control', placeholder: 'Search for anything i.e. table number, team members, title', :autofocus => true %>
        </div>
        <span class="col-auto">
          <%= submit_tag 'Search', name: nil, class: 'btn btn-secondary' %>
        </span>
      </div>
      <%end%>
    </div>
  </div>
  <div class="card">
    <div class="table-responsive">
      <table class="table table-hover table-outline table-vcenter text-nowrap card-table">
        <thead>
          <tr>
            <th>Table #</th>
            <th>Title</th>
            <th>Description</th>
            <th>Link</th>
            <th>Team Members</th>
          </tr>
        </thead>

        <tbody>
          <% @projects.each do |project| %>
          <tr>
            <% if project.table_id.nil? %>
              <td>TBD</td>
            <% else %>
              <td><%= project.table_id %></td>
            <% end %>
            <td><%= link_to truncate(project.title, length: 15), project %></td>
            <td><%= truncate(project.description, length: 30) %></td>
            <td><%= truncate(project.link, length: 22) %></td>
            <td>
              <% proj_users = "" %>
              <% project.user.each do |u|  %>
                <% proj_users << u.first_name + " "%>
                <% if u != project.user.last %>
                  <% proj_users << u.last_name + ", "%>
                <% else %>
                  <% proj_users << u.last_name %>
                <% end %>
              <% end %>
              <%= truncate(proj_users, length: 30) %>
            </td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<br>

<center>
  <%= will_paginate @projects %>
</center>
